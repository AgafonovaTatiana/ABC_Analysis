Задача:

1.	Провести многомерный ABC-анализ по 3 признакам:

•	количество проданных штук товара
•	сумма продаж
•	месячная оборачиваемость

2.	На том же наборе данных провести XYZ-анализ и дополнить многомерный ABC-анализ еще и группой XYZ по каждому товару.

Минимальное количество дней продаж каждого товара - 3 дня. Если меньше, считается, что группу по XYZ оценить невозможно.

Месячная оборачиваемость рассчитывается как среднедневное количество продаж, умноженное на 30 дней. Эта метрика показывает, сколько штук товара в месяц мы потенциально можем продать. Расчет среднедневного количества продаж производится следующим образом: Кол-во проданных товаров / Кол-во дней в периоде.

Пояснения к столбцам исходной таблицы:
DR_Dat - дата покупки
DR_Tim - время покупки
DR_NChk - номер чека
DR_NDoc - номер кассового документа
DR_Apt - номер аптеки
DR_Shop - номер магазина (FK - shops)
DR_Kkm - номер кассового аппарата
DR_TDoc - вид документа
DR_TPay - форма платежа (18 - безнал, 15 - нал)
DR_CDrugs - артикул товара
DR_NDrugs - название товара
DR_Suppl - поставщик
DR_Prod - производитель
DR_Kol - кол-во проданного товара
DR_CZak - закупочная цена
DR_CRoz - розничная цена
DR_SDisc - сумма скидки
DR_CDisc - код скидки
DR_BCDisc - штрихкод скидки
DR_TabEmpl - табельный номер сотрудника (FK - employee)
DR_Pos - номер позиции в чеке
DR_VZak - вид закупки (1 - обычный, 2 - интернет-заказ)

NB: Скидка (DR_SDisc) применяется не к каждой штуке товара (DR_Kol), а к итоговому количеству. Перемножать эти поля не нужно.

 
Решение:

1.	В основную таблицу с данными добавляем две колонки для удобства проведения расчетов:
DR_CSales – сумма продаж = Кол-во проданных единиц * Стоимость 1 единицы товара
DR_CSalesDisc – сумма продаж с учетом примененной скидки = Сумма продаж – Размер скидки. Этот показатель будем использовать для АВС анализа
2.	Из массива данных на отдельном листе “Totals Pivot” создаем сводную таблицу с уникальными значениями названий товара, а также суммарным количеством продаж в штуках и в деньгах с учетом скидки. Эту таблицу берем за основу на лист “ABC_data” для оформления расчетов по АВС.
3.	На отдельном листе “Avg per month calc” проводим расчет среднего количества продаж за период. Для этого находим минимальную и максимальную дату периода и рассчитываем сколько дней в периоде. В данном примере в этом нет особой необходимости, т.к. визуально понятно, что всего в периоде 5 дней. Находим среднее кол-во продаж за месяц по формуле из условия задачи (Среднедневное кол-во продаж * 30 дней). Данные подтягиваем на основной лист “ABC_data” расчета с помощью VLOOKUP. Также на данном листе мы делаем расчет, сколько штук товара было продано в каждую из дат. Это станет основой для расчетов для XYZ анализа.
4.	Далее работаем на основном листе “ABC_data”. В колонке “% PCS” Находим % соотношение количества проданного товара к общему количеству проданного товара. Сортируем получившийся столбец в убывающем порядке. В отдельном столбце “%PCS cumulative” показываем % накопительным итогом для удобства присвоения категорий АВС.
5.	В колонке “PCS ABC” с помощью функции ЕСЛИ присваиваем категории А, В и С всем товарам. Здесь и в дальнейшем применяется следующее разделение категорий:
Категория А: от 0% до 79%
Категория В: от 80% до 94%
Категория С: от 95% до 100%
6.	Аналогичные расчет проводим для метрик по сумме продаж и по месячной оборачиваемости.
7.	В отдельный столбец “ABC Total” сводим результаты по всем трем ключевым параметрам и получаем категорию АВС для каждой позиции из списка.
8.	На итоговом листе “ABC_result” представлена сводная таблица с количеством товаров в каждой группе. 
9.	Переходим к XYZ анализу. На листе “Avg per month calc” добавляем колонку “Sales days”. Для каждой позиции из списка считаем количество дней, где продажи != 0.
10.	В колонке “Var” рассчитываем вариативность продаж – среднее отклонение по продажам в штуках, если “Sales days” >= 3.
11.	С помощью функции ВПР подтягиваем итоговое значение в колонку “Var” на листе “ABC_data”. В колонке “XYZ” проводим анализ: Если в колонке “Var” стоит “N/A”, значит анализ по XYZ провести невозможно. Соответственно в колонку “XYZ” также проставляется “N/A”. Далее применяется следующее разделение категорий:
Категория X: от 0% до 9%
Категория Y: от 10% до 24%
Категория Z: от 25% до 100%
12.	В колонку “ABC-XYZ” объединяем столбцы “ABC” и “XYZ”. Если анализ по XYZ провести невозможно, оставляем только значение из колонки “ABC”.
13.	На отдельный лист “ ABC-XYZ_result” выводим сводную таблицу с количеством позиций в каждой из групп.

 
Промежуточные выводы:
1.	Для полноты анализа и принятия решений по имеющимся группам необходимо также смотреть маржинальность по проблемным позициям.
2.	В категории ССС получилось довольно много товаров – 78 шт – мало продаж с низкой выручкой и низкой оборачиваемостью за месяц. 
a.	Некоторые из позиций продавались поштучно – возможно стоит уйти от тактики поштучной продажи и продавать упаковку целиком, что повысит сумму продаж по данной позиции.
b.	Некоторые позиции возможно переместить в зону кассы, продавцы могут их предлагать при продаже, стоит также проверить, выложены ли они вообще на витрину.
3.	В категориях с низким количеством продаж на основании данных по маржинальности можно предложить скидки и акции. Скорректировать выкладку на витрине для привлечения внимания к данным позициям.
4.	Для категорий со средним и высоким количеством продаж, но маленькой суммой продажи возможно рассмотреть увеличение стоимости, особенно если у них низкая маржинальность.
5.	Все позиции получились либо с очень высоким средним отклонением, либо невозможно было провести XYZ анализ
