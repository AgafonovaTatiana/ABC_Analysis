Задача:

Провести многомерный ABC-анализ по 3 признакам:

1.	количество проданных штук товара
2.	сумма продаж
3.	месячная оборачиваемость

Месячная оборачиваемость рассчитывается как среднедневное количество продаж, умноженное на 30 дней. Эта метрика показывает, сколько штук товара в месяц мы потенциально можем продать. Расчет среднедневного количества продаж производится следующим образом: Кол-во проданных товаров / Кол-во дней в периоде.

Пояснения к столбцам исходной таблицы:
DR_Dat - дата покупки
DR_Tim - время покупки
DR_NChk - номер чека
DR_NDoc - номер кассового документа
DR_Apt - номер аптеки
DR_Shop - номер магазина (FK - shops)
DR_Kkm - номер кассового аппарата
DR_TDoc - вид документа
DR_TPay - форма платежа (18 - безнал, 15 - нал)
DR_CDrugs - артикул товара
DR_NDrugs - название товара
DR_Suppl - поставщик
DR_Prod - производитель
DR_Kol - кол-во проданного товара
DR_CZak - закупочная цена
DR_CRoz - розничная цена
DR_SDisc - сумма скидки
DR_CDisc - код скидки
DR_BCDisc - штрихкод скидки
DR_TabEmpl - табельный номер сотрудника (FK - employee)
DR_Pos - номер позиции в чеке
DR_VZak - вид закупки (1 - обычный, 2 - интернет-заказ)

NB: Скидка (DR_SDisc) применяется не к каждой штуке товара (DR_Kol), а к итоговому количеству. Перемножать эти поля не нужно.

 
Решение:

1.	В основную таблицу с данными добавляем две колонки для удобства проведения расчетов:
DR_CSales – сумма продаж = Кол-во проданных единиц * Стоимость 1 единицы товара
DR_CSalesDisc – сумма продаж с учетом примененной скидки = Сумма продаж – Размер скидки. Этот показатель будем использовать для АВС анализа
2.	Из массива данных на отдельном листе “Totals Pivot” создаем сводную таблицу с уникальными значениями названий товара, а также суммарным количеством продаж в штуках и в деньгах с учетом скидки. Эту таблицу берем за основу на лист “ABC_data” для оформления расчетов по АВС.
3.	На отдельном листе “Avg per month calc” проводим расчет среднего количества продаж за период. Для этого находим минимальную и максимальную дату периода и рассчитываем сколько дней в периоде. В данном примере в этом нет особой необходимости, т.к. визуально понятно, что всего в периоде 5 дней. Находим среднее кол-во продаж за месяц по формуле из условия задачи (Среднедневное кол-во продаж * 30 дней). Данные подтягиваем на основной лист “ABC_data” расчета с помощью VLOOKUP
4.	Далее работаем на основном листе “ABC_data”. В колонке “% PCS” Находим % соотношение количества проданного товара к общему количеству проданного товара. Сортируем получившийся столбец в убывающем порядке. В отдельном столбце “%PCS cumulative” показываем % накопительным итогом для удобства присвоения категорий АВС.
5.	В колонке “PCS ABC” с помощью функции ЕСЛИ присваиваем категории А, В и С всем товарам. Здесь и в дальнейшем применяется следующее разделение категорий:
Категория А: от 0% до 79%
Категория В: от 80% до 94%
Категория С: от 95% до 100%
6.	Аналогичные расчет проводим для метрик по сумме продаж и по месячной оборачиваемости.
7.	В отдельный столбец “ABC Total” сводим результаты по всем трем ключевым параметрам и получаем категорию АВС для каждой позиции из списка.
8.	На итоговом листе “ABC_result” представлена сводная таблица с количеством товаров в каждой группе. 

 
Промежуточные выводы:
1.	Для полноты анализа и принятия решений по имеющимся группам необходимо также смотреть маржинальность по проблемным позициям.
2.	В категории ССС получилось довольно много товаров – 78 шт – мало продаж с низкой выручкой и низкой оборачиваемостью за месяц. 
a.	Некоторые из позиций продавались поштучно – возможно стоит уйти от тактики поштучной продажи и продавать упаковку целиком, что повысит сумму продаж по данной позиции.
b.	Некоторые позиции возможно переместить в зону кассы, продавцы могут их предлагать при продаже, стоит также проверить, выложены ли они вообще на витрину.
3.	В категориях с низким количеством продаж на основании данных по маржинальности можно предложить скидки и акции. Скорректировать выкладку на витрине для привлечения внимания к данным позициям.
4.	Для категорий со средним и высоким количеством продаж, но маленькой суммой продажи возможно рассмотреть увеличение стоимости, особенно если у них низкая маржинальность.
